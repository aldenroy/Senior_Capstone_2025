<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Search</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<h2 class="text-center">Movie Search</h2>

<!-- Search Bar -->
<div class="search-container">
    <label for="searchInput" class="visually-hidden">Search for a movie</label>
    <input type="text" id="searchInput" class="search-box" placeholder="Enter movie title..." onkeypress="handleKeyPress(event)" aria-label="Search for a movie" />
    <button class="search-btn" onclick="searchMovies()" aria-label="Search movies">Search</button>
</div>

<!-- Movie Results -->
<section id="results" aria-live="polite" role="status"></section>

<script>
    async function searchMovies() {
        let query = document.getElementById("searchInput").value.trim();
        if (query === "") return;

        let response = await fetch(`/Home/SearchMovies?query=${encodeURIComponent(query)}`);
        let movies = await response.json();

        let resultsContainer = document.getElementById("results");
        resultsContainer.innerHTML = "";

        if (movies.length === 0) {
            resultsContainer.innerHTML = "<div class='no-results' role='alert'>No results found.</div>";
            return;
        }

        movies.forEach(movie => {
            let movieCard = document.createElement("article");
            movieCard.className = "movie-card";
            movieCard.innerHTML = `
                <div class="movie-row" aria-label="Search results card for ${movie.title}">
                    <img src="${movie.posterUrl || 'https://via.placeholder.com/150'}" class="movie-poster" alt="${movie.title} movie poster">
                    <div class="movie-details" aria-label="Movie details for ${movie.title}">
                        <h5 aria-label="Movie title is ${movie.title}">${movie.title} <span class="movie-year">(${movie.releaseYear || 'N/A'})</span></h5>
                        <p class="movie-genres">Genres: ${movie.genres?.join(", ") || 'Unknown'}</p>
                        <button class="btn btn-primary" aria-label="View details for ${movie.title}">View Details</button>
                        <button class="btn btn-outline-secondary" aria-label="Find more movies like ${movie.title}">More Like This</button>
                    </div>
                </div>
            `;
            resultsContainer.appendChild(movieCard);
        });
    }

    function handleKeyPress(event) {
        if (event.key === "Enter") {
            searchMovies();
        }
    }
</script>

<style>
    .visually-hidden {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
    }
</style>

</body>